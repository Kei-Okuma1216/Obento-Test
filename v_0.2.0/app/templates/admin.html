<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>管理者メイン画面</title>
    <!-- Bootstrap CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
  </head>
  <body class="bg-light">

    {% include 'components/header.html' %}
    
    <!-- メインコンテンツ -->
    <div class="container mt-4">
      <!-- タブナビゲーション -->
      <ul class="nav nav-tabs" id="adminTab" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="function-tab" data-bs-toggle="tab" data-bs-target="#function" type="button" role="tab" aria-controls="function" aria-selected="true">機能</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="log-tab" data-bs-toggle="tab" data-bs-target="#log" type="button" role="tab" aria-controls="log" aria-selected="false">ログ</button>
        </li>
      </ul>
      
      <!-- タブコンテンツ -->
      <div class="tab-content" id="adminTabContent">
        <!-- 機能タブ -->
        <div class="tab-pane fade show active" id="function" role="tabpanel" aria-labelledby="function-tab">
          <h1 class="mt-3 text-dark">管理者メイン画面</h1>
          <p>admin</p>
          <a class="btn btn-secondary" href="#">未実装</a>
          <ul class="list-group mt-3">
            <li class="list-group-item">注文一覧</li>
            <li class="list-group-item">FAX送信ボタン</li>
            <li class="list-group-item">予定表編集UI</li>
            <li class="list-group-item">
              <a href="{{ base_url }}/admin/me/update_existing_passwords">
                DBにあるユーザーパスワードをすべて暗号化する
              </a>
            </li>
            <li class="list-group-item">
              <a href="/admin/logs">ログファイル一覧</a>
            </li>
            <li class="list-group-item">
              <a href="{{ base_url }}/admin/order_logs">
                注文ログファイル一覧
              </a>
            </li>
            <li class="list-group-item">
              <a href="{{ base_url }}/admin/logs/2025-03-19.log?highlight=DEBUG">
                <del>ログファイル詳細</del>
              </a>
            </li>
            <li class="list-group-item">
              <a href="{{ base_url }}/test_exception">
                例外テスト
              </a>
            </li>
          </ul>      
        </div>
        <!-- 例外テストリンク -->
        <!--<div class="mt-3 text-center">
          <a href="/test_exception" class="btn btn-link">例外テスト</a>
        </div>-->    
        <!-- ログタブ -->
        <div class="tab-pane fade" id="log" role="tabpanel" aria-labelledby="log-tab">
          <h1 class="mt-3">ログ</h1>
          <!-- Bootstrap の Modal を利用してログ表示ウィンドウを開く -->
          <button type="button" class="btn btn-primary mt-3" data-bs-toggle="modal" data-bs-target="#logModal">
            ログ表示ウィンドウを開く
          </button>
        <!--</div>-->
          <!-- 注文ログ表示ボタン -->
          <button type="button" class="btn btn-primary mt-3" onclick="location.href='/admin/order_logs'">
            注文ログ表示
          </button>
        </div>    
      </div>
    </div>

    <!-- ログ Dialog-->
    <!-- Bootstrap Modal for log display -->
    <div class="modal fade" id="logModal" tabindex="-1" aria-labelledby="logModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="logModalLabel">ログ表示</h5>
            <div class="btn-group">
              <!-- 戻るボタン -->
              <button type="button" class="btn btn-sm btn-secondary me-2" onclick="goBackInIframe()">戻る</button>
              <!-- 閉じるボタン -->
              <button type="button" class="btn btn-sm btn-secondary" data-bs-dismiss="modal">閉じる</button>
            </div>
          </div>
          <div class="modal-body p-0">
            <!-- /admin/logs の内容を iframe で表示 -->
            <iframe src="/admin/logs" width="100%" height="500" frameborder="0"></iframe>
          </div>
        </div>
      </div>
    </div>

    <!-- 注文ログ -->
    <!-- Bootstrap Modal for log display -->
    <div class="modal fade" id="orderlogModal" tabindex="-1" aria-labelledby="logModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="logModalLabel">注文ログ表示</h5>
            <div class="btn-group">
              <!-- 戻るボタン -->
              <button type="button" class="btn btn-sm btn-secondary me-2" onclick="goBackInIframe()">戻る</button>
              <!-- 閉じるボタン -->
              <button type="button" class="btn btn-sm btn-secondary" data-bs-dismiss="modal">閉じる</button>
            </div>
          </div>
          <div class="modal-body p-0">
            <!-- /admin/logs の内容を iframe で表示 -->
            <iframe src="/admin/order_logs" width="100%" height="500" frameborder="0"></iframe>
          </div>
        </div>
      </div>
    </div>
    

    <!-- フッター -->
    <!--<footer class="bg-dark text-light py-4">
      <div class="container text-center">
        <p>&copy; 2025 会社名. All Rights Reserved.</p>
        <ul class="list-inline">
          <li class="list-inline-item"><a href="#" class="text-light">プライバシーポリシー</a></li>
          <li class="list-inline-item"><a href="#" class="text-light">利用規約</a></li>
          <li class="list-inline-item"><a href="#" class="text-light">お問い合わせ</a></li>
        </ul>
      </div>
    </footer>-->

    {% include 'components/footer.html' %}

    <!-- Bootstrap Bundle with Popper CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script>
      function goBackInIframe() {
        var iframe = document.querySelector('iframe');
        if (iframe && iframe.contentWindow) {
          iframe.contentWindow.history.back();
        }
      }
    </script>
  </body>
</html>
