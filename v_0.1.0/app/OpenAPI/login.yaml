openapi: 3.0.3
info:
  title: お弁当注文システム API
  description: API for ordering bento lunches
  version: 1.0.0
servers:
  - url: https://localhost:8000/
    description: Development server
  - url: https://www.sample.com
    description: Production server
paths:
  /:
    get:
      summary: アクセスポイント画面
      description: |
        ### 有効期限内のtokenの有無により
        - 存在する場合 
          - /users/me/place-order へ遷移します。
        - 存在しない場合 
          - /regist へ遷移します。
      responses:
        '200':
          description: アクセスポイントにアクセス
          content:
            text/html:
              schema:
                type: string
                example: |
                  <html>
                      <head>
                          <title>お弁当注文システム</title>
                          <script>|
                              document.addEventListener("DOMContentLoaded", function() {
                                  // Cookieからトークンを取得
                                  let token = document.cookie
                                      .split('; ')
                                      .find(row => row.startsWith('token='))
                                      ?.split('=')[1];
                                  
                                  // トークンの有効期限を確認する（例: tokenの中に有効期限情報がある前提）
                                  if (token) {
                                      // トークンが有効の場合
                                      window.location.href = "/users/me/place-order";
                                  } else {
                                      // トークンが無効または存在しない場合
                                      window.location.href = "/regist";
                                  }
                              });
                          </script>
                      </head>
                      <body>
                          <h1>読み込み中...</h1>
                      </body>
                  </html>
  /regist:
    get:
      summary: ユーザー登録画面
      responses:
        '200':
          description: ログイン画面表示
          content:
            text/html:
              schema:
                type: string
                example: |
                  <html>
                      <head>
                          <title>ユーザー登録</title>
                      </head>
                      <body>
                          <h1>こんにちは！</h1>
                          <form action="/register" method="post">
                              <label for="username">ID:</label><br>
                              <input type="text" id="username" name="username"><br>
                              <label for="password">パスワード:</label><br>
                              <input type="password" id="password" name="password"><br>
                              <input type="submit" value="OK">
                          </form>
                      </body>
                  </html>
components:
  schemas:
    AuthorizationStatus:
      type: string
      enum:
        - user
        - shop
        - admin
  responses:
    '200':
      description: OK
    '400':
      description: Bad Request
    '401':
      description: Unauthorized
    '403':
      description: Forbidden
    '404':
      description: Not Found
    '500':
      description: Internal Server Error
    '503':
      description: Service Unavailable
